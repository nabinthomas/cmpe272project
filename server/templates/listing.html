<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en-US">

<head profile="http://www.w3.org/2005/10/profile">
    <link rel="icon" type="image/png" href="/static/favicon.png">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js" crossorigin="anonymous"> </script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <title>aMAZE.com > Listing</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style type="text/css">
        .page_layout_style {
            max-width: 90%;
            min-width: 90%;
            padding-top: 10px;
            padding-left: 10px;
            border-style: solid;
            align:center;
        }

        .search_criteria_column_style {
            max-width: 150px;
            width: 150px;
            min-width: 150px;
            padding-top: 2px;
            padding-left: 2px;
            
            
        }

        .listings_table_style {
            width: 100%;
            padding-top: 2px;
            padding-left: 2px;
            padding-right: 2px;
            padding-bottom: 2px;
            border: 1px;
            border-color: gainsboro;
            border-style: double;
        }

        .listings_table_header_style {
            width: 100%;
            padding-top: 2px;
            padding-left: 2px;
            padding-right: 2px;
            padding-bottom: 2px;
            border: 1px;
            border-color: gainsboro;
            border-style: double;
            background-color: lightgrey;
        }

        .listings_table_body_style {
            width: 100%;
            padding-top: 2px;
            padding-left: 2px;
            padding-right: 2px;
            padding-bottom: 2px;
            border: 1px;
            border-color: lightcyan;
            border-style: double;
        }
        .thumnail_image {
            padding: 1px;
            background-color: black;
            transition: transform 1s;
            width: 50px;
            height: 50px;
            margin: 0 auto;
        }
        .thumnail_image:hover {
            -ms-transform: scale(5); /*  IE 9 */
            -webkit-transform: scale(5); /* Safari 3-8  */
            transform: scale(5); 
        } 
        .listing_image {
            padding: 1px;
            background-color: black;
            transition: transform 1s;
            width: 200px;
            height: 200px;
            margin: 0 auto;
            align: center;
        }
        .listing_image:hover {
            -ms-transform: scale(2); /*  IE 9 */
            -webkit-transform: scale(2); /* Safari 3-8  */
            transform: scale(2); 
        } 

        /* Style the button that is used to open and close the collapsible content */
        .collapsible {
        background-color: #eee;
        color: #444;
        cursor: pointer;
        padding: 18px;
        width: 100%;
        border: none;
        text-align: left;
        outline: none;
        font-size: 15px;
        }

        /* Add a background color to the button if it is clicked on (add the .active class with JS), and when you move the mouse over it (hover) */
        .active, .collapsible:hover {
        background-color: #ccc;
        }

        /* Style the collapsible content. Note: hidden by default */
        .miscellaneous_data_collapsible_section {
        padding: 0 18px;
        display: none;
        overflow: hidden;
        background-color: #f1f1f1;
        }

        #location_map {
        width: 100%;
        height: 400px;
        background-color: grey;
      }
    </style>
</head>

<body>
    <table id=page_layout class=page_layout_style align="center" >
        <!-- Top row for icons, Page title and Logout button Total 3 columns -->
        <tr id=top_row_for_title_bars>
            <td align="left" class=search_criteria_column_style>
                <img style="float: left; margin: 0px 0px 0px 0px;" src="/static/favicon.png" width="30" height="30" />
            </td>
            <td align="left" width=70%>
                <a href="/">aMAZE.com</a> &gt; <a href=/listings>Listings </a> &gt; <span id=listings_table_heading></span>
            </td>
            <td align="right" width=33%>
                <table>
                    <tr>
                        <td id="logout_button"></td>
                        <td id="profilePic"></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <!--Listing Table 3 column layout by default, but can be adjusted with colspan -->
            <td colspan=3 valign=top>
                <table  id=listings_table class="listings_table_style" >
                        <thead class=listings_table_header_style>
                                <th align="center"  id=listing_name>
                                        Loading Details..
                                </th>
                        </thead>
                        <tbody class=listings_table_body_style id=listing_table_data>
                            <!-- Each tr below can be an item to be displayed in the UI from the listing data -->
                            <tr>
                                <td  id=listing_image align="center">
                                    <!---
                                    <img src=https://a0.muscache.com/im/pictures/44620/5a5815c6_original.jpg?aki_policy=large>
                                    -->
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <b> Hosted By: </b>
                                                </td>
                                                <td id=host_name>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td id=host_thumbnail >                                                    
                                                </td>
                                                <td id=host_score >                                                    
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <b> Bedrooms: </b>
                                                </td>
                                                <td id=bedrooms>
                                                    Unknown
                                                </td>
                                                <td>
                                                    &nbsp;
                                                </td>
                                                <td>
                                                    <b> Bathrooms: </b>
                                                </td>
                                                <td id=bathrooms>
                                                    Unknown
                                                </td>
                                                <td>
                                                        &nbsp;
                                                </td>
                                                <td>                                                    
                                                   <b>Beds : </b> 
                                                </td>
                                                <td id=beds>                                                    
                                                    Unknown
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                            </tr>
                            <tr><td>
                                <table style="border:1px; border-color: lightskyblue; border-style: solid">
                                    <thead style="border:2px; border-color: lightskyblue; border-style: solid">
                                        <th style="padding: 10px 10px 10px 10px">  Accuracy </th>
                                        <th style="padding: 10px 10px 10px 10px"> Checkin</th>
                                        <th style="padding: 10px 10px 10px 10px"> Cleanliness</th>
                                        <th style="padding: 10px 10px 10px 10px"> Communication</th>
                                        <th style="padding: 10px 10px 10px 10px"> Location</th>
                                        <th style="padding: 10px 10px 10px 10px"> Rating</th>
                                        <th style="padding: 10px 10px 10px 10px"> Value</th>
                                    </thead>
                                    <tbody style="border:2px; border-color: lightskyblue; border-style: solid">
                                        <td align=center id=accuracyScore style="padding: 10px 10px 10px 10px">&nbsp;</td>
                                        <td align=center id=checkinScore style="padding: 10px 10px 10px 10px">&nbsp;</td>
                                        <td align=center id=cleanlinessScore style="padding: 10px 10px 10px 10px">&nbsp;</td>
                                        <td align=center id=communicationScore style="padding: 10px 10px 10px 10px">&nbsp;</td>
                                        <td align=center id=locationScore style="padding: 10px 10px 10px 10px">&nbsp;</td>
                                        <td align=center id=ratingScore style="padding: 10px 10px 10px 10px">&nbsp;</td>
                                        <td align=center id=valueScore style="padding: 10px 10px 10px 10px">&nbsp;</td>
                                    </tbody>
                                </table>
                            </td></tr>
                            
                            <tr>
                                <td>
                                    <table>                                        
                                        <th>
                                            <b>Address:</b>
                                        </th>
                                        <tr>
                                            <td id=street>
                                                
                                            </td>
                                        </tr>
                                        <tr>
                                            <td id=state>
                                                
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>Description</b>
                                </td>
                            </tr>
                            <tr>
                                <td id=description>
                                    Details about the Property
                                </td>
                            </tr>
                            <tr>
                                    <td>
                                        <!--  This holds all the map for the listing -->
                                        <button class="collapsible">Show/Hide Map</button>
                                        <div class="miscellaneous_data_collapsible_section">
                                                <div id="fixed_size_misc_section" style="height: 400px;position:relative;">
                                                    <div id="scrollable_misc_section" style="max-height:100%;overflow:auto;border:1px solid red;">
                                                        <div id=location_map_container onshow="refreshMap()">
                                                            <div id=location_map latitude=0 longitude=0>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                        </div>
                                    </td>
                                </tr>
                            <tr>
                                <td>
                                    <!--  This holds all the miscellaneous data in Listing -->
                                    <button class="collapsible">Click to Show/Hide More Listing Details</button>
                                    <div class="miscellaneous_data_collapsible_section">
                                            <div id="fixed_size_misc_section" style="height: 250px;position:relative;">
                                                <div id="scrollable_misc_section" style="max-height:100%;overflow:auto;border:1px solid red;">
                                                    <table id=miscellaneous_data_table>
                                                    </table>
                                                </div>
                                            </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <!-- 
                                    This is the section where reviews are added. 
                                    It The React Classes that render this is the one which fetches the data from REST
                                    API server and trigger update of all the other sections.
                                --> 
                                <td>
                                    <button class="collapsible">Click to Show/Hide Reviews</button>
                                    <div class="miscellaneous_data_collapsible_section">
                                        <div id="fixed_size_review_section" style="height: 250px;position:relative;">
                                            <div id="scrollable_review_section" style="max-height:100%;overflow:auto;border:1px solid red;">
                                               <table id=complete_listing_data>


                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                </table>
            </td>
        </tr>
    </table>
    <!-- BEGIN REACT IMPORTS -->
        <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
        <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>

        <script type="module" src="/static/scripts/Listing.js"></script>
        <script type="module" src="/static/scripts/logout.js"></script>
        <script type="module" src="/static/scripts/autohomepage.js"></script>
        <script type="module" src="/static/scripts/SearchBar.js"></script>
    <!-- END REACT IMPORTS -->

    <!-- BEGIN Custom scripts -->
    <script>
        // Now refill the Query Form with the URL Parameters to keep them in sync
        getUrl = window.location;
        console.log (" URL " + getUrl);
        var listingID = getUrl.pathname.split('/')[2]
        //console.log ("BINU " + getUrl.pathname.split('/')[2]); 

        // Handle Collapsible miscellaneous Data section 
        var coll = document.getElementsByClassName("collapsible");
        var i;

        for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function() {
            this.classList.toggle("active");
            var content = this.nextElementSibling;
            if (content.style.display === "block") {
            content.style.display = "none";
            } else {
            content.style.display = "block";
            }
            refreshMap();
        });
        }

        var listingLocation = { lat : 0, lng:0 }
        var map = null;
        var marker = null;
        // For Google Maps
        function initMap() {
            // The location of the listing
            var mapelement = document.getElementById('location_map')
            listingLocation.lat = Number(mapelement.getAttribute('latitude'));
            listingLocation.lng = Number(mapelement.getAttribute('longitude'));
            // The map, centered at listing
            map = new google.maps.Map(
                document.getElementById('location_map'), { zoom: 13, center: listingLocation });
            // The marker, positioned at listing
            marker = new google.maps.Marker({ position: listingLocation, map: map });
            console.log("initMap Done ")
            // refreshMap();
        }

        function refreshMap() {
            console.log("Refresh maps enter ")
            if ((map == null) || (marker == null)) {
                initMap();
            }
            if ((map != null)  && (marker != null)) {
                var mapelement = document.getElementById('location_map')
                
                listingLocation.lat = Number(mapelement.getAttribute('latitude'));
                listingLocation.lng = Number(mapelement.getAttribute('longitude'));
                var markerLocation = new google.maps.LatLng(listingLocation.lat, listingLocation.lng);
                marker.setPosition(markerLocation);
                map.setCenter(markerLocation);
                console.log("Refresh maps " + markerLocation)
            }
        }

    </script>
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDrjbh9s3zntJTmE4epBbhD6IkotEyLYn0&callback=initMap">
    </script>
    <!-- END  Custom scripts -->
</body>
<footer> <div align=center> &copy;2019 Team aMAZE. All Rights Reserved </div> </footer>
</html>